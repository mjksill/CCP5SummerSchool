<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Statistical Mechancs 1</title>
<meta name="author" content="Leo Lue"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="../../reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="../../reveal.js/dist/theme/black.css" id="theme"/>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">

<section>
<section id="slide-org240c4ba" data-background="../figures/bitmap/Boltzmann_grave.jpg" data-background-size="100%">
<h2 id="org240c4ba"></h2>
<h1 style="background-color:rgba(1, 1, 1, 0.5)">
Statistical Mechanics 1
</h1>
<br>
<br>

<div style="background-color:rgba(1, 1, 1, 0.5)">
<h3>
<p>
Leo Lue
</p>

<p>
Department of Chemical &amp; Process Engineering
</p>

<p>
University of Strathclyde
</p>
</h3>
</div>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org3c6fefa" data-background="../figures/bitmap/Boltzmann_grave.jpg" data-background-size="100%">
<h2 id="org3c6fefa">Statistical mechanics</h2>

<p class="backbox" style="background:rgba(0, 0, 0, 0.5)">
<em>
  Ludwig Boltzmann, who spent much of his life studying statistical mechanics, died in 1906, by his own hand. Paul Ehrenfest, carrying on the work, died similarly in 1933. Now it is our turn to study statistical mechanics. Perhaps it will be wise to approach the subject cautiously.
</em>
<p class="backbox" style="background:rgba(0, 0, 0, 0.5);float:right">
(Opening lines of "States of Matter", by D.L. Goodstein).
</p>
</p>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org9d12d81">
<h2 id="org9d12d81">Statistical mechanics</h2>
<div class="column" style="float:left; width:50%">

<div id="org908db9e" class="figure">
<p><img src="../figures/bitmap/water.png" alt="water.png" height="500" />
</p>
</div>
</div>

<div class="column" style="float:right; width:50%">

<div id="org261b59e" class="figure">
<p><img src="../figures/bitmap/liquidwater.png" alt="liquidwater.png" height="500" width="auto" />
</p>
</div>
</div>

<aside class="notes">
<p>
And so this is the kind of system mechanics is going to be one of the
cornerstones of what you're going to learn in this module. So this
kind of interesting question is, you know, so that you know that
there's like 10 to the 23 you know in in a gram of water, around 10 or
20, three kind of molecules of water. And if you think about all the
different numbers, you have to specify to get the positions and
velocities of every single particle. Every single water molecule in
the system. You just think that you know there's too much
information. How do you know that you have the same sort of bunch of
water than someone else, right? But what's kind of interesting is that
if you think of water from thermodynamics, how many different
parameters you need to specify in order to kind of make sure that you
have the same water in the same state as someone else. And the answer
is like 2 right? You need to know like temperature and pressure or
temperature and density.
</p>

<p>
So how did you actually reduce something that actually is is 10 to the
23 degrees of freedom.  Down to something with just two degrees of
freedom.
</p>

<p>
Alright, and what's sort of interesting is that that's kind of related
to, well, this. This sort of how everything kind of reduces to
Gaussian Statistics.
</p>

<p>
It's also kind of interesting in terms of like when you get huge
numbers of multiple when you have huge numbers of events.  Actually,
things are much more predictable than if you just have single events,
right? So that's why sort of when you're gambling in a casino.  You
know whether you win or lose in a particular day or whatever, is
actually very difficult to kind of predict, right?
</p>

<p>
But the casino always wins 'cause they know very precisely. Given that
you know 1000 people gamble everyday or 10,000 people gamble or
there's 10,000 kind of games going on. They can tell you pretty
precisely how many people are gonna win and how many people going to
lose and what the distribution of that's going to be.
</p>

<p>
And so even though the individual events may be very difficult to. To
determine The actual statistics of them are actually quite
reproducible, and you can actually do a lot to kind of model
that. Yep, next slide, thanks.
</p>

</aside>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org9bf97e0">
<h2 id="org9bf97e0">Overview</h2>
<ul>
<li>Thermodynamics</li>
<li>Microscopic dynamics</li>
<li>Statistical mechanics</li>

</ul>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org89bde37">
<h2 id="org89bde37">Basic concepts in thermodynamics</h2>
<p>
Thermodynamics is a phenomenological theory that describes the
properties of systems, and their relationships, when in equilibrium.
</p>

<ul>
<li>Properties:
<ul>
<li>state vs path</li>
<li>intensive vs extensive</li>

</ul></li>

</ul>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org6baf25f">
<h2 id="org6baf25f">First law of thermodynamics</h2>
<blockquote>
<b>First law of thermodynamics:</b>
Energy cannot be created or destroyed, but it can transform from one
form to another.
</blockquote>

<br>

<div>
\begin{align*}
d(E + {\rm KE} + {\rm PE} + \cdots)
&= \delta Q - \delta W 
\end{align*}

</div>

<ul>
<li>What do we mean by energy?
<ul>
<li>kinetic, internal, thermal, electromagnetic, gravitational, etc.</li>

</ul></li>
<li>Heat</li>
<li>Work
<ul>
<li>pressure: \(-pdV\)</li>
<li>interfacial tension: \(-\sigma dA\)</li>
<li>chemical potential: \(\mu_\alpha dN_\alpha\)</li>
<li>\(\delta W'\): other</li>

</ul></li>

</ul>


<div>
\begin{align*}
d(E + {\rm KE} + {\rm PE} + \cdots)
&=
\delta Q - pdV + \mu dN - \delta W'
\end{align*}

</div>


<aside class="notes">
<p>
The first law of thermodynamics guarantees that energy is conserved.
</p>

<p>
Energy can take on many different forms, and these forms can be
converted to one another; however, energy can neither be created or
destroyed.
</p>

<p>
So the statement that we need to
conserve energy use to help the environment does not
really make sense, 
because about energy use   However, we know that there is something to that
statement that rings true.  We do not live in a world with
inexhaustible resources.
</p>

<p>
So the question is what is the real problem?
</p>

<p>
What is a renewable resource?
</p>

</aside>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org415a372">
<h2 id="org415a372">Second law of thermodynamics</h2>
<blockquote>
<b>Clausius statement:</b>
No process is possible whose sole result is the transfer of heat from
a body of lower temperature to a body of higher temperature.
</blockquote>
<blockquote>
<b>Kelvin-Planck statement:</b>
No process is possible in which the sole result is the absorption of
heat from a reservoir and its complete conversion into work.
</blockquote>
<br>

<div>
\begin{align*}
dS \ge \frac{\delta Q}{T}
\end{align*}

</div>

<img src="https://aatishb.com/entropy/media/onewaytotwoway.gif" width=800>


<aside class="notes">
<p>
The second law of thermodynamics is interesting in that it is one of
the few laws of physics that is not reversible.  Most physical
dynamical equations, such as Newton's laws of motion or even the
Schrodinger equation, are the same moving forward and backward in
time.  This is not the case for the second law of thermodynamics,
which does show a difference.
</p>

<p>
If you accidentally view a film backward, you will immediately notice
it because it will look "unusual".  This
</p>


<p>
While different forms of energy can be converted to each other, some
</p>

<p>
In this sense, not all forms of energy have equal "value".
</p>

<p>
This provides an
</p>

<p>
While different forms of energy can be converted to each other, some
forms of energy
</p>

<p>
In this sense, not all forms of energy have equal "value".
</p>

<p>
This provides an
</p>

</aside>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org888ee27">
<h2 id="org888ee27">Combined first and second laws</h2>
<ul>
<li><p>
first law
</p>
<div>
\begin{align*}
dE &= \delta Q - pdV + \sum_\alpha \mu_\alpha dN_\alpha - \delta W'
\end{align*}  

</div></li>

<li><p>
second law  
</p>
<div>
\begin{align*}
\delta Q \le T dS 
\end{align*}

</div></li>

<li><p>
combined first and second laws
</p>
<div>
\begin{align*}
dE &\le TdS - pdV + \sum_\alpha \mu_\alpha dN_\alpha - \delta W'
\\
\delta W'  &\le - dE + TdS - pdV + \sum_\alpha \mu_\alpha dN_\alpha
\end{align*}

</div></li>

</ul>


<aside class="notes">
<p>
Combining the first and second laws of thermodynamics, we arrive at
this inequality.
</p>

<p>
Work is a form of energy that can be perfectly converted to any other
form of energy.
</p>


<p>
We see that every 
</p>


<p>
From this expression, we see that the energy of the system
can be con
</p>

<p>
Work is a form of energy that can be perfectly converted to any other
form of energy.  
</p>

<p>
The difficulty with using this inequality
</p>

</aside>



<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org16d57d0">
<h2 id="org16d57d0">Fundamental equation of thermodynamics</h2>
<div>
\begin{align*}
dE &\le TdS - pdV - \delta W' + \sum_\alpha \mu_\alpha dN_\alpha
\end{align*}

</div>

<aside class="notes">
<p>
This tells
</p>

</aside>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-orgdd0189a">
<h2 id="orgdd0189a">maximum entropy</h2>
<div>
\begin{equation*}
dS = \frac{dE}{T} + \frac{p}{T}dV - \frac{\mu}{T}dN
\end{equation*}

</div>

<aside class="notes">
nil
</aside>


<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org635ea23">
<h2 id="org635ea23">Legendre transforms and free energies</h2>


<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-orgfd25c0e">
<h2 id="orgfd25c0e">maximum work</h2>
<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org4dcb31d">
<h2 id="org4dcb31d">Calculus of thermodynamics</h2>
<div>
\begin{equation*}
dS = \frac{dE}{T} + \frac{p}{T}dV - \frac{\mu}{T}dN
\end{equation*}

</div>

<div>
\begin{equation*}
df
=
\left(\frac{\partial f}{\partial x}\right)_{y,z} dx
+ \left(\frac{\partial f}{\partial y}\right)_{x,z} dy
+ \left(\frac{\partial f}{\partial z}\right)_{x,y} dz
\end{equation*}

</div>

<div>
\begin{align*}
\frac{\partial S}{\partial T}
&= \frac{1}{T}
\qquad
\frac{\partial S}{\partial V}
=
\frac{p}{T}
\qquad
\frac{\partial S}{\partial N}
=
- \frac{\mu}{T}
\end{align*}

</div>



<aside class="notes">
<p>
From the fundamental equation of thermodynamics, we can deduce
relations between the various properties of the system.  To see this,
let's consider a function \(f\) with independent variables \(x\) and \(y\).
The differential of \(f\) (i.e.\ the total change in \(f\)) can be written
as given here.
</p>

<p>
The first term represents the change in \(f\) due to changes in the
independent variable \(x\), and the second term representce changes due
to the independent variable \(y\).  Note that this equation is just a
generalization of a first order Taylor series expansion to a function
of three variables.
</p>

</aside>


<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org0305c6e">
<h2 id="org0305c6e">Maxwell relations</h2>
<div>
\begin{align*}
\frac{\partial}{\partial x}
\frac{\partial f}{\partial y}
&=
\frac{\partial}{\partial y}
\frac{\partial f}{\partial x}
\end{align*}

</div>

<div>
\begin{align*}
\left[\frac{\partial}{\partial V}\left(\frac{1}{T}\right)\right]_{E,N}
&=
\left[\frac{\partial}{\partial E} \left(\frac{p}{T}\right)\right]_{V,N}
\quad
\left[\frac{\partial}{\partial N}\left(\frac{1}{T}\right)\right]_{E,V}
=
- \left[\frac{\partial}{\partial E} \left(\frac{\mu}{T}\right)\right]_{V,N}
\quad
\left[\frac{\partial}{\partial N} \left(\frac{p}{T}\right)\right]_{E,V}
=
- \left[\frac{\partial}{\partial V}\left(\frac{\mu}{T}\right)\right]_{V,N}
\end{align*}

</div>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org85ce79b">
<h2 id="org85ce79b">Importance of free energy</h2>
<ul>
<li>Knowledge of the free energy of the system in terms of its "natural"
variables, all equilibrium thermodynamics properties can be
determined.</li>

<li>The free energy represents the maximum work that can be extracted from a transformation
if it is spontaneous or the minimum
work required to perform a transformation if it is non-spontaneous.</li>

</ul>


<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org1388ebe" data-background="../figures/bitmap/Boltzmann_grave.jpg" data-background-size="100%">
<h2 id="org1388ebe">Entropy</h2>
<p class="backbox" style="background:rgba(0, 0, 0, 0.5)">
  <img src="../figures/bitmap/Boltzmann_equation.jfif"><br/>
</p>
<p>
where \(W=\Omega\), and \(k.=k_B\).
</p>


<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-orgcf72462">
<h2 id="orgcf72462">Entropy</h2>
<ul>
<li>The second law of thermodynamics, put simply, is that
the most likely things will eventually happen and stay
there.</li>

<li>Richard Feynman says in his Lectures on Physics “…
entropy is just the logarithm of the number of ways of
internally arranging a system while &lt;loaded&gt;have it look the same
from the outside&lt;/loaded&gt;”.&lt;/p&gt;</li>

<li>Entropy is a measure of how much we don't know, i.e. it
measures our lack of control-over/measurement-of the
microstate.&lt;/p&gt;</li>

<li>Entropy is NOT disorder/chaos, its just that there's so many
ways to make a mess&#x2026;</li>

<li>Sometimes order is more likely, i.e., look at any
crystal transition.</li>

</ul>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org6e5def4">
<h2 id="org6e5def4">Microcanonical ensemble</h2>
<p>
We have derived the key relationships of the &lt;b&gt;micro-canonical ensemble&lt;/b&gt;,
where the system is isolated (typically \(N,\,V,\,E\) held constant in molecular systems):
</p>
<div>
\begin{align*}
P(N,\,U, \ldots) &= \frac{\Omega\left(N, U, \ldots\right)}{\sum_U \Omega\left(N,\,U, \ldots\right)}
&
S(N,\,U, \ldots) &= k_B \ln \Omega\left(N, U, \ldots\right)
\end{align*}

</div>

<p>
Other thermodynamic properties can be generated from here, just like
in normal thermodynamics
</p>
<div>
\begin{align*}
\left\langle U\right\rangle &= \sum_U U\,P(N,\,U, \ldots) &
\mu &= - T\frac{\partial S(N,\,U, \ldots)}{\partial N}
\end{align*}	      

</div>

<p>
We do not have pressure or any other work variable in this system,
we'd need to have some "volume" and "pressure" that somehow
contributes to the dice roll for that.
</p>

<p>
However, we do still have temperature, although it requires us to add
the first law.
</p>


<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org3f8acbb">
<h2 id="org3f8acbb">Averaging</h2>
<p>
&lt;p&gt;
  &lt;em&gt;God does not play dice. &lt;span style="float:right;"&gt;A. Einstein&lt;/span&gt;&lt;/em&gt;
&lt;/p&gt;
&lt;p style="clear:right;" class="fragment"&gt;
  &lt;em&gt;God does play dice with the universe. All the evidence points to him being an inveterate gambler, who throws the dice on every possible occasion. &lt;span style="float:right;"&gt;S. Hawking&lt;/span&gt;&lt;/em&gt;
&lt;/p&gt;
&lt;p class="fragment"&gt;
  You are the omnipotent being of your simulation, so you get to choose:
  &lt;span style="font-size:75%"&gt;
</p>
<div>
\begin{align*}
\langle{\mathcal A}\rangle &= \sum_{\boldsymbol\Gamma} d{\boldsymbol\Gamma}\,P({\boldsymbol\Gamma})\,
{\mathcal A}({\boldsymbol\Gamma}) & \text{(Monte Carlo)}\\
&\text{or}\\
\langle{\mathcal A}\rangle&=\lim_{t_{obs.}\to\infty} \frac{1}{t_{obs.}}\int_0^{t_{obs.}}\mathcal A(t)\,{\rm d}t & \text{(Molecular Dynamics)}
\end{align*}

</div>
<p>
  &lt;/span&gt;
&lt;/p&gt;	    
&lt;p class="fragment"&gt;
  &lt;b&gt;But are these equivalent? If so, the system is &lt;u&gt;Ergodic&lt;/u&gt;.&lt;/b&gt;
&lt;/p&gt;
</p>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org2c86b0e">
<h2 id="org2c86b0e">Dynamics of the simple harmonics oscillator</h2>
<p>
&lt;p&gt;
  Consider the &lt;b&gt;S&lt;/b&gt;imple &lt;b&gt;H&lt;/b&gt;armonic &lt;b&gt;O&lt;/b&gt;scillator:
  &lt;img src="img/SHO.gif"&gt;&lt;br/&gt;
&lt;/p&gt;
&lt;p class="fragment"&gt;
  The &lt;b&gt;microstate&lt;/b&gt; variables, in this case position,
  \(r\), and velocity, \(v=\dot{r}\), can be collected together to
  form a vector, \(\boldsymbol \Gamma\), which exists in &lt;b&gt;phase space&lt;/b&gt;.&lt;/p&gt;
&lt;div class="attribution backbox"&gt;
  Image: 
  &lt;i&gt;&lt;a href="<img src="https://en.wikipedia.org/wiki/Simple_harmonic_motion#/media/File:Simple_Harmonic_Motion_Orbit.gif" alt="File:Simple_Harmonic_Motion_Orbit.gif" />" title="User:XRay"&gt;Mazemaster - public domain&lt;/a&gt;
  &lt;/i&gt;
&lt;/div&gt;
</p>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-orgfcad055">
<h2 id="orgfcad055">simple harmonic oscillator</h2>
<p>
  The <b>microcanonical</b> SHO system visits all regions of phase space pretty quickly, it is therefore <b>Ergodic</b>. Stat-Mech
  and (molecular) dynamics averages are equivalent.</p>
<div class="backbox">
  <div class="form-group">
	<label for="shocount1">Ensemble members:&nbsp;</label><output id="shocount1output" for="shocount1">1</output>
	<input type="range" class="form-control-range" id="shocount1" min="1" max="50" value="1" step="1">
  </div>
</div>
<div id="shocount1div" style="margin:auto 0; display:inline-block;" ></div>
<script>
 (function() {
   var state = {
   };

   function init(n) {
	 state.n = n;
	 state.dt = 0.015;
	 state.x = [];
	 state.y = [];
	 state.tinit = [];
	 state.A = [];
	 state.t = 0;
	 
	 for (i = 0; i < state.n; i++) {
	   state.tinit[i] = Math.random();
	   state.A[i] = 1.0;
	 };
   };

   function step() {
	 state.t += state.dt;
	 for (i = 0; i < state.n; i++) {
	   var phase = 2 * 3.14159265 * (state.tinit[i] + state.t);
	   state.x[i] = state.A[i] * Math.sin(phase);
	   state.y[i] = state.A[i] * Math.cos(phase);
	 };
   };

   init(1);
   step();

   $('#shocount1').on('input change', 
			  (e) => {
			    $('#shocount1output').text(e.target.value);
			    init(e.target.valueAsNumber); 
   });
   
   var animating = false;

   function update () {
	 step();

	 Plotly.animate('shocount1div', {
	   data: [{
	     x: state.x, 
	     y: state.y, 					
	     marker: {
	       color: [...Array(state.x.length).keys()],
	       cmin: 0,
	       cmax:state.x.length,
	     },
	   }],
	 }, {
	   transition: {
	     duration: 0
	   },
	   frame: {
	     duration: 0,
	     redraw: false
	   }
	 });
	 
	 if (animating)
	   requestAnimationFrame(update);
	 else {
	   Plotly.purge('shocount1div');
	 }
   }

   Reveal.on( 'slidechanged', event => {
	 if (event.currentSlide.id == 'shocount1slide') {
	   Plotly.newPlot('shocount1div', 
			    {
			      data:	[{
				x: state.x,
				y: state.y,
				marker: {
				  color: [...Array(state.x.length).keys()],
				  colorscale: 'Rainbow',
				},
			      mode: 'markers',
			    }],
			    layout:  { 
			      xaxis: { title: 'r', range: [-1.5, 1.5]},
			      yaxis: { title: 'v', range: [-1.5, 1.5]},
			      plot_bgcolor: '#000',
			      paper_bgcolor: '#000E',
			      font: {
				color: 'white',
				size: 15,
			      },
			    },
			    config: default_plot_Config,
	   });
	   Reveal.layout();
	   animating = true;
	   requestAnimationFrame(update);
	 } else {
	   animating = false;
	 }
   });
 })();
</script>
<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org142ef46">
<h2 id="org142ef46">Hamiltonian</h2>
<p>
&lt;p&gt;
  Its not surprising that it forms a circle in phase space,
  as the total energy (called the Hamiltonian), is the
  equation of a circle in \(r\) and \(v\).
</p>

<div>
\begin{align*}
U = \mathcal{H}(\boldsymbol{\Gamma}) = \frac{1}{2}k\,r^2 + \frac{1}{2}m\,v^2
\end{align*}

</div>
<p>
  where \(k\) is the spring constant and \(m\) is the mass. 
&lt;/p&gt;
&lt;p class="fragment"&gt;
  What is all of phase space like? We can sample all energies, \(U\), and plot the "flow" of trajectories:
&lt;/p&gt;
</p>
<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-orgf259c6f">
<h2 id="orgf259c6f">phase space "flow"</h2>
<div style="display:flex">
  <img src="img/SHOflow1.svg" style="flex:1" />
  <div style="flex:1" >
    <p style="padding-left:1em;">
      The systems flow around phase space, the trajectory
      lines do not cross, thus this behaves exactly as a
      incompressible fluid.
    </p>
    <p class="fragment" style="padding-left:1em;">
      Whatever <b>ensemble</b> of starting states we begin
      with, there's a symmetry to its motion through phase
      space. If evenly distributed, it will remain evenly
      distributed.
    </p>
  </div>
</div>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-orgf48e911">
<h2 id="orgf48e911">Liouville's Theorem</h2>
<p>
We can treat an ensemble of systems flowing around phase
space as an incompressible fluid with density
\(\rho(\boldsymbol{\Gamma})\), thus it behaves as follows:
</p>
<div>
\begin{align*}
\nabla_{\boldsymbol{\Gamma}}
\cdot [\dot{\boldsymbol\Gamma}\,\rho({\boldsymbol\Gamma})]
=
\sum_i \left(
\dot{
  \boldsymbol{r}}_i\cdot \frac{\partial}{\partial \boldsymbol{r}_i}
  + \dot{\boldsymbol{v}}_i \cdot \frac{\partial}{\partial \boldsymbol{v}_i}
\right)
\rho\left(\left\{\boldsymbol{r}_i,\,\boldsymbol{v}_i\right\}^N_i\right)
= 0
\end{align*}

</div>
<p>
which should be familiar to you as a simplification of
the continuity equation from any fluid flow class you
might have had:
</p>
<div>
\begin{align*}
\frac{\partial \rho}{\partial t}
+ \nabla \cdot [\rho\,\boldsymbol{v}] = 0
\end{align*}

</div>

<p>
This is the foundation of kinetic theory, as from here
comes the BBGKY heirarchy and ultimately
Boltzmann's/Enskog's equation.
p&gt;
</p>

<p>
Back to ergodicity.
</p>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org2e66d29">
<h2 id="org2e66d29">Double well potential</h2>
<p>
The SHO system has a parabolic potential energy:
</p>
<div>
\begin{align*}
U(\boldsymbol{\Gamma}) = \mathcal{H}(r,\,v) = \frac{1}{2}k\,r^2 + \frac{1}{2}m\,v^2
\end{align*}

</div>

<p>
We can make a double-well potential simply by shifting the spring rest
position away from the origin:
</p>
<div>
\begin{align*}
U(\boldsymbol{\Gamma}) = \mathcal{H}(r,\,v) = \frac{1}{2}k\,\left(\left|r\right|-r_0\right)^2 + \frac{1}{2}m\,v^2
\end{align*}

</div>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-orgc2cc031">
<h2 id="orgc2cc031">Double well potential</h2>
<div class="backbox">	
  <div class="row">
	<div class="col">
	  <div class="form-group">
	    <label for="shocount2">Ensemble members: </label><output id="shocount2output" for="shocount2">1</output><br/>
	    <input type="range" class="form-control-range" id="shocount2" min="1" max="500" value="200" step="1">
	  </div>
	</div>
	<div class="col">
	  <div class="form-group">
	    <label for="shocount2dt">Time step: </label><output id="shocount2dtout" for="shocount2dt">1</output><br/>
	    <input type="range" class="form-control-range" id="shocount2dt" min="0.005" max="0.4" value="0.1" step="0.005">
	  </div>
	</div>
  </div>
</div>
<div id="shocount2div" style="margin:auto 0; display:inline-block;" ></div>
<p>
  Are the systems in the lower energies (closer to the centre of the
  orbits) ergodic? No, they cannot visit each other even though they're
  at the same energy level (thus at the same state)!
</p>
<script>
 (function() {
   var state = {
	 x: [],
	 y: []
   };
   var beta = 0; 
   var omega = 1;
   var gamma = 2 * beta;
   var k = omega * omega + gamma * gamma / 4;
   var m = 1
   var r0 = 1;


   function init() {
	 state.n = $('#shocount2')[0].valueAsNumber;
	 $('#shocount2output').text(state.n.toString());
	 state.dt = $('#shocount2dt')[0].valueAsNumber;
	 $('#shocount2dtout').text(state.dt.toString());
	 
	 if (state.n != state.x.length) {
	   state.x = [];
	   state.y = [];
	   for (i = 0; i < state.n; i++) {
	     state.x[i] = 3.0 * 2 * (Math.random() - 0.5);
	     state.y[i] = 3.0 * (Math.random() - 0.5);
	   };
	 }
   };

   function accel(i) {
	 var ri = state.x[i];
	 var vi = state.y[i];
	 return - k * (Math.abs(ri) / ri) * (Math.abs(ri) - r0);
   }

   function step() {
	 for (i = 0; i < state.n; i++) {
	   var ai  = accel(i);
	   state.x[i] += state.dt * state.y[i] + 0.5 * ai * state.dt * state.dt;
	   state.y[i] += 0.5 * state.dt * ai;
	   var ai  = accel(i);
	   state.y[i] += 0.5 * state.dt * ai;
	 };
   };

   init();
   step();

   $('#shocount2').on('input change', 
			  (e) => {
			    init(); 
   });

   $('#shocount2dt').on('input change',
			  (e) => {
			    init(); 
   });
   
   var animating = false;	       
   function update () {
	 step();

	 Plotly.animate('shocount2div', {
	   data: [{
	     x: state.x, 
	     y: state.y,
	     marker: {
	       color: [...Array(state.x.length).keys()],
	       cmin: 0,
	       cmax:state.x.length,
	     },
	   }],
	 },{ 
	   transition: {
	     duration: 0
	   },
	   frame: {
	     duration: 0,
	     redraw: false
	   }
	 });

	 if (animating)
	   requestAnimationFrame(update);
	 else {
	   Plotly.purge('shocount2div')
	 }
   }

   Reveal.on( 'slidechanged', event => {
	 if (event.currentSlide.id == 'shocount2slide') {
	   Plotly.newPlot('shocount2div', 
			  {
			    data:	[{
			      x: state.x,
			      y: state.y,
			      mode: 'markers',
			      marker: {
				color: [...Array(state.x.length).keys()],
				colorscale: 'Jet',
				cmin: 0,
				cmax:state.x.length,
			      },
			    }],
			    layout:  { 
			      xaxis: { title: 'r', range: [-4, 4]},
			      yaxis: { title: 'v', range: [-4, 4]},
			      plot_bgcolor: '#000',
			      paper_bgcolor: '#000E',
			      font: {
				color: 'white',
				size: 15,
			      },
			    },
			    config: default_plot_Config,
	   });
	   Reveal.layout();
	   
	   animating = true;
	   requestAnimationFrame(update);
	 } else {
	   animating = false;
	 }
   });	       
 })();
</script>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org8c9765a">
<h2 id="org8c9765a">double-well dynamics</h2>
<img src="img/SHOsplit.svg" style="width:100%" />

<p>
<b>Microstates</b> in \(U=0.25\) are energetically isolated from each other,
thus its not ergodic; however, a lot of properties (i.e. average
velocity) will still work out!
</p>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-orge03f1a7">
<h2 id="orge03f1a7">Ergodicity</h2>
<p>
Phase space is so unbelievably big even for small
systems it actually &amp;ldquo;feels&amp;rdquo; impossible for any
trajectory to meaningfully visit all microstates (or come
close enough to do so) in finite time.
</p>

<p>
Practically, in simulation we typically just check averages are
converging and hope we are "effectively" ergodic.  Like a lot of
things in simulation, you presume it might be true but verify as best
you can.
</p>

<p>
There are many techniques for accelerating dynamics past energy
barriers and "encourage" good sampling of phase space
which you will learn about in your MC lectures.  These are also applied
more frequently to MD simulations too.
</p>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org4bed680">
<h2 id="org4bed680">Statistical mechanics</h2>
<p>
The ideas of statistical mechanics are simple, yet the
implications and relationships it provides are deep and
meaningful.
</p>

<p>
My dice example should make you believe that its
applications are wider than just molecular
systems. Isaac Asimov even explored the statistical
mechanics of galactic societies in his excellent (but a little
dated) <a href="https://en.wikipedia.org/wiki/Foundation_series">Foundation Series</a>.  Who
knows where it will turn up next.
</p>

<p>
While much of the derivations covered here are "ancient", there's
still intense research into the field, and many more surprising
results to find.
</p>

<p>
I hope you're keen to find out more, and will look at the statistical
mechanics underlying all your upcoming lectures as a mountain to climb
up, rather than a chasm to fall in.
</p>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org030d4d9">
<h2 id="org030d4d9">Questions?</h2>
<div class="slide-footer"></div>
</section>
</section>
</div>
</div>
<script src="../../reveal.js/dist/reveal.js"></script>
<script src="../../reveal.js/plugin/markdown/markdown.js"></script>
<script src="../../reveal.js/plugin/zoom/zoom.js"></script>
<script src="../../reveal.js/plugin/notes/notes.js"></script>


<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
plugins: [RevealMarkdown, RevealZoom, RevealNotes],
width:"100%", height:"100%",
});

</script>
</body>
</html>
